# Gin Starter

Этот проект представляет собой стартовый шаблон для веб-приложений на Go с использованием фреймворка Gin и шаблонизатора templ.

## Особенности

- Использование фреймворка [Gin](https://gin-gonic.com/) для маршрутизации
- Использование шаблонизатора [templ](https://templ.guide/) для генерации HTML
- Поддержка SQLite базы данных
- Интеграция с Tailwind CSS (локально)
- Использование Alpine.js для клиентской интерактивности
- Автоматическая перезагрузка кода с помощью Air
- Улучшенная безопасность с использованием gin-contrib/secure
- Поддержка CORS для взаимодействия с внешними фронтендами
- Версионирование API (v1)
- Разделение ответственности между обработчиками HTML и API

## Установка

1. Убедитесь, что у вас установлены Go 1.18+ и Bun
2. Склонируйте репозиторий
3. Установите Go зависимости: `go mod tidy`
4. Установите JavaScript зависимости: `bun install`
5. Установите Air для горячей перезагрузки: `go install github.com/cosmtrek/air@latest`
6. Скопируйте `.env.example` в `.env` и настройте переменные окружения
7. Сгенерируйте CSS файлы: `bun run build:css`
8. Запустите приложение: `air`

## Работа с Tailwind CSS

Для разработки с использованием Tailwind CSS:

- Для генерации production CSS: `bun run build:css`
- Для разработки с автоперезагрузкой CSS: `bun run dev`

## Структура проекта

```
.
├── .air.toml                # Конфигурация Air (горячая перезагрузка)
├── .env                     # Файл конфигурации окружения
├── .env.example             # Пример файла .env
├── .genkit/                 # Директория для Genkit (фреймворк для разработки приложений)
│   ├── runtimes/            # Временные файлы выполнения
│   ├── servers/             # Серверные файлы
│   ├── traces/              # Файлы трассировки
│   └── traces_idx/          # Индекс трассировки
│       └── genkit.metadata  # Метаданные Genkit
├── .gitignore               # Файлы и директории, игнорируемые Git
├── .golangci.yml            # Конфигурация linter для Go
├── bun.lock                 # Lock-файл для Bun
├── check.bat                # Скрипт проверки
├── cmd/                     # Директория команд (точки входа)
│   └── server/              # Серверное приложение
│       └── main.go          # Точка входа в приложение
├── data/                    # Директория для данных
│   └── data.db              # SQLite база данных
├── docker-compose.yml       # Конфигурация Docker Compose
├── Dockerfile               # Файл для сборки Docker образа
├── go.mod                   # Модули Go
├── go.sum                   # Суммы зависимостей Go
├── internal/                # Внутренние пакеты приложения
│   ├── config/              # Конфигурация приложения
│   │   └── config.go        # Настройки приложения
│   ├── database/            # Инициализация базы данных
│   │   └── db_init.go       # Инициализация подключения к БД
│   ├── handlers/            # Обработчики HTTP запросов
│   │   ├── image.go         # Обработчики изображений
│   │   ├── page_handler.go  # Обработчики страниц (HTML)
│   │   ├── pages.go         # Обработчики страниц
│   │   ├── user_handler.go  # Обработчики API (новый)
│   │   └── users.go         # Обработчики пользователей
│   ├── image/               # Обработка изображений
│   │   ├── cache.go         # Кеширование изображений
│   │   ├── handler.go       # Обработчик изображений
│   │   └── service.go       # Сервис обработки изображений
│   ├── middleware/          # HTTP middleware
│   │   └── middleware.go    # Middleware приложения
│   ├── models/              # Модели данных
│   │   └── user.go          # Модель пользователя
│   ├── repository/          # Репозитории для работы с базой данных
│   │   ├── sqlite_user_repository.go  # Репозиторий пользователей SQLite
│   │   └── user.go          # Интерфейс пользователя
│   ├── routes/              # Маршруты приложения
│   │   └── router.go        # Настройка маршрутов (обновленный)
│   ├── service/             # Бизнес-логика
│   │   └── image/           # Сервисы обработки изображений
│   │       ├── cache.go     # Кеширование изображений
│   │       └── processor.go # Обработка изображений
│   └── store/               # Интерфейсы и реализации хранилищ
│       ├── sqlite_store.go  # Реализация хранилища SQLite
│       └── store.go         # Интерфейс хранилища
├── Makefile                 # Скрипты сборки и управления
├── node_modules/            # Зависимости Node.js
├── package.json             # Конфигурация Node.js проекта
├── static/                  # Статические файлы (CSS, JS, изображения)
│   ├── css/                 # Стили
│   │   ├── global.css       # Глобальные стили
│   │   ├── input.css        # Входной файл стилей
│   │   ├── tailwind-safelist.txt  # Whitelist для Tailwind CSS
│   │   ├── tailwind.css     # Сгенерированные стили Tailwind
│   │   └── tailwind.min.css # Минимизированные стили Tailwind
│   ├── images/              # Изображения
│   │   ├── face_01.png      # Демонстрационное изображение
│   │   └── favicons/        # Фавиконки
│   │       ├── apple-touch-icon.png      # Apple touch иконка
│   │       ├── favicon-96x96.png         # Фавиконка 96x96
│   │       ├── favicon.ico               # ICO фавиконка
│   │       ├── favicon.svg               # SVG фавиконка
│   │       ├── site.webmanifest          # Web manifest
│   │       ├── web-app-manifest-192x192.png  # Web app иконка 192x192
│   │       └── web-app-manifest-512x512.png  # Web app иконка 512x512
│   ├── js/                  # JavaScript файлы
│   │   ├── app.js          # Основной JS файл
│   │   └── tailwind.min.js # Минимизированный JS для Tailwind
│   ├── robots.txt          # Файл для поисковых роботов
│   └── sitemap.xml         # Карта сайта
├── templates/               # Шаблоны templ
│   ├── components/          # Компоненты интерфейса
│   │   ├── about/          # Компоненты страницы "О нас"
│   │   ├── base/           # Базовые компоненты
│   │   ├── home/           # Компоненты главной страницы
│   │   └── layout/         # Компоненты макета
│   │       ├── footer/     # Компоненты подвала
│   │       └── header/     # Компоненты заголовка
│   ├── layouts/             # Макеты страниц
│   │   ├── footer/          # Компоненты подвала сайта
│   │   │   ├── footer.templ # Шаблон подвала
│   │   │   └── footer_templ.go  # Сгенерированный Go код подвала
│   │   ├── header/          # Компоненты шапки сайта (включая меню и логотип)
│   │   │   ├── header.templ # Шаблон заголовка
│   │   │   ├── header_templ.go  # Сгенерированный Go код заголовка
│   │   │   ├── logo.templ   # Шаблон логотипа
│   │   │   ├── logo_templ.go # Сгенерированный Go код логотипа
│   │   │   └── menu.go      # Структура и функции меню
│   │   ├── layout.templ     # Основной шаблон макета
│   │   └── layout_templ.go  # Сгенерированный Go код макета
│   ├── pages/               # Страницы приложения
│   │   ├── about.templ      # Шаблон страницы "О нас"
│   │   ├── about_templ.go   # Сгенерированный Go код страницы "О нас"
│   │   ├── contact.templ    # Шаблон страницы "Контакты"
│   │   ├── contact_templ.go # Сгенерированный Go код страницы "Контакты"
│   │   ├── index.templ      # Шаблон главной страницы
│   │   ├── index_templ.go   # Сгенерированный Go код главной страницы
│   │   ├── users.templ      # Шаблон страницы пользователей
│   │   └── users_templ.go   # Сгенерированный Go код страницы пользователей
│   └── templates.go         # Вспомогательные функции шаблонов
├── tailwind.config.js       # Конфигурация Tailwind CSS
├── tmp/                     # Временные файлы
│   ├── build-errors.log     # Лог ошибок сборки
│   └── main.exe             # Временный исполняемый файл
└── README.md               # Документация проекта
```

## Функциональность

### Страница пользователей

В проект была добавлена страница управления пользователями со следующими возможностями:

- Просмотр списка пользователей из базы данных
- Добавление новых пользователей через форму
- Удаление пользователей с подтверждением через модальное окно
- Отображение сообщений об успешных операциях и ошибках в модальных окнах
- Компактная таблица пользователей с ограниченной шириной
- Интеграция с базой данных для хранения информации о пользователях

### Модальные окна

Все взаимодействия с пользователем происходят через модальные окна:

- Подтверждение удаления пользователя
- Сообщения об успешном добавлении/удалении
- Сообщения об ошибках
- Форма добавления нового пользователя

### Безопасность

- Защита от XSS атак через заголовки безопасности
- Защита от clickjacking через заголовок X-Frame-Options
- Защита от MIME-type sniffing через заголовок X-Content-Type-Options
- Использование пакета gin-contrib/secure для комплексной защиты

### Архитектурные улучшения

- Разделение ответственности: создан отдельный UserHandler для API-маршрутов
- Версионирование API: теперь API доступен по пути `/api/v1`
- Поддержка CORS: добавлена поддержка кросс-доменных запросов
- Улучшенная структура маршрутов с логическим разделением на веб-страницы и API

## Переменные окружения

- `SERVER_PORT` - порт, на котором запускается сервер (по умолчанию 8080)
- `DB_TYPE` - тип базы данных (sqlite или postgres)
- `DB_PATH` - путь к файлу SQLite базы данных (для SQLite)
- `DB_HOST`, `DB_PORT`, `DB_USER`, `DB_PASSWORD`, `DB_NAME` - параметры подключения к PostgreSQL

## Технологии

- [Go](https://golang.org/)
- [Gin Framework](https://gin-gonic.com/)
- [templ](https://templ.guide/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Alpine.js](https://alpinejs.dev/)
- [Air](https://github.com/cosmtrek/air)
- [gin-contrib/secure](https://github.com/gin-contrib/secure) - для безопасности
- [gin-contrib/cors](https://github.com/gin-contrib/cors) - для поддержки CORS
